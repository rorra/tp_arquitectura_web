.container
  .row.mt-4
    .col-lg-8
      .card
        .card-header.bg-white
          %h2.h4.mb-0 Checkout

        .card-body
          = form_with(model: @order, local: true) do |f|
            - if @order.errors.any?
              .alert.alert-danger
                %h4.alert-heading= "#{pluralize(@order.errors.count, "error")} prohibited this order from being saved:"
                %ul.mb-0
                  - @order.errors.full_messages.each do |msg|
                    %li= msg

            .mb-3
              = f.label :state, "State/Province", class: "form-label"
              = f.text_field :state, class: "form-control", required: true

            .mb-3
              = f.label :city, class: "form-label"
              = f.text_field :city, class: "form-control", required: true

            .mb-3
              = f.label :zip, "Postal Code", class: "form-label"
              = f.text_field :zip, class: "form-control", required: true

            .mb-3
              = f.label :address, "Street Address", class: "form-label"
              = f.text_field :address, class: "form-control", required: true

            .mb-3
              = f.label :phone, "Phone Number", class: "form-label"
              = f.telephone_field :phone, class: "form-control", required: true

            .d-grid.gap-2.mt-4
              = f.submit "Place Order", class: "btn btn-primary btn-lg"
              = link_to "Back to Cart", cart_path, class: "btn btn-outline-secondary"

    .col-lg-4
      .card
        .card-header.bg-white
          %h3.h5.mb-0 Order Summary
        .card-body
          - current_cart.cart_items.each do |item|
            .d-flex.justify-content-between.mb-2
              %span
                = item.product.name
                %small.text-muted
                  x#{item.quantity}
              %span= number_to_currency(item.total_price)

          %hr

          .d-flex.justify-content-between.mb-2
            %span.fw-bold Total Items:
            %span= current_cart.cart_items.sum(&:quantity)

          .d-flex.justify-content-between.mb-2
            %span.fw-bold Total:
            %span.h5= number_to_currency(current_cart.cart_items.sum(&:total_price))